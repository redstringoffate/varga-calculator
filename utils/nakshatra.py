# utils/nakshatra.py

# ----------------------------------------
# Nakshatra & Pada absolute hardcoded table (108 segments)
# ----------------------------------------

from utils.sign import SIGN_TO_NUM


# Each tuple = (start_deg, end_deg, nakshatra_name, pada)
NAKSHATRA_PADA = [
    # Ashwini (1)
    (0.0, 3.3333333333, "Ashwini", 1),
    (3.3333333333, 6.6666666666, "Ashwini", 2),
    (6.6666666666, 9.9999999999, "Ashwini", 3),
    (9.9999999999, 13.3333333333, "Ashwini", 4),

    # Bharani (2)
    (13.3333333333, 16.6666666666, "Bharani", 1),
    (16.6666666666, 19.9999999999, "Bharani", 2),
    (19.9999999999, 23.3333333333, "Bharani", 3),
    (23.3333333333, 26.6666666666, "Bharani", 4),

    # Krittika (3)
    (26.6666666666, 29.9999999999, "Krittika", 1),
    (29.9999999999, 33.3333333333, "Krittika", 2),
    (33.3333333333, 36.6666666666, "Krittika", 3),
    (36.6666666666, 39.9999999999, "Krittika", 4),

    # Rohini (4)
    (39.9999999999, 43.3333333333, "Rohini", 1),
    (43.3333333333, 46.6666666666, "Rohini", 2),
    (46.6666666666, 49.9999999999, "Rohini", 3),
    (49.9999999999, 53.3333333333, "Rohini", 4),

    # Mrigashira (5)
    (53.3333333333, 56.6666666666, "Mrigashira", 1),
    (56.6666666666, 59.9999999999, "Mrigashira", 2),
    (59.9999999999, 63.3333333333, "Mrigashira", 3),
    (63.3333333333, 66.6666666666, "Mrigashira", 4),

    # Ardra (6)
    (66.6666666666, 69.9999999999, "Ardra", 1),
    (69.9999999999, 73.3333333333, "Ardra", 2),
    (73.3333333333, 76.6666666666, "Ardra", 3),
    (76.6666666666, 79.9999999999, "Ardra", 4),

    # Punarvasu (7)
    (79.9999999999, 83.3333333333, "Punarvasu", 1),
    (83.3333333333, 86.6666666666, "Punarvasu", 2),
    (86.6666666666, 89.9999999999, "Punarvasu", 3),
    (89.9999999999, 93.3333333333, "Punarvasu", 4),

    # Pushya (8)
    (93.3333333333, 96.6666666666, "Pushya", 1),
    (96.6666666666, 99.9999999999, "Pushya", 2),
    (99.9999999999, 103.3333333333, "Pushya", 3),
    (103.3333333333, 106.6666666666, "Pushya", 4),

    # Ashlesha (9)
    (106.6666666666, 109.9999999999, "Ashlesha", 1),
    (109.9999999999, 113.3333333333, "Ashlesha", 2),
    (113.3333333333, 116.6666666666, "Ashlesha", 3),
    (116.6666666666, 119.9999999999, "Ashlesha", 4),

    # Magha (10)
    (119.9999999999, 123.3333333333, "Magha", 1),
    (123.3333333333, 126.6666666666, "Magha", 2),
    (126.6666666666, 129.9999999999, "Magha", 3),
    (129.9999999999, 133.3333333333, "Magha", 4),

    # Purva Phalguni (11)
    (133.3333333333, 136.6666666666, "Purva Phalguni", 1),
    (136.6666666666, 139.9999999999, "Purva Phalguni", 2),
    (139.9999999999, 143.3333333333, "Purva Phalguni", 3),
    (143.3333333333, 146.6666666666, "Purva Phalguni", 4),

    # Uttara Phalguni (12)
    (146.6666666666, 149.9999999999, "Uttara Phalguni", 1),
    (149.9999999999, 153.3333333333, "Uttara Phalguni", 2),
    (153.3333333333, 156.6666666666, "Uttara Phalguni", 3),
    (156.6666666666, 159.9999999999, "Uttara Phalguni", 4),

    # Hasta (13)
    (159.9999999999, 163.3333333333, "Hasta", 1),
    (163.3333333333, 166.6666666666, "Hasta", 2),
    (166.6666666666, 169.9999999999, "Hasta", 3),
    (169.9999999999, 173.3333333333, "Hasta", 4),

    # Chitra (14)
    (173.3333333333, 176.6666666666, "Chitra", 1),
    (176.6666666666, 179.9999999999, "Chitra", 2),
    (179.9999999999, 183.3333333333, "Chitra", 3),
    (183.3333333333, 186.6666666666, "Chitra", 4),

    # Swati (15)
    (186.6666666666, 189.9999999999, "Swati", 1),
    (189.9999999999, 193.3333333333, "Swati", 2),
    (193.3333333333, 196.6666666666, "Swati", 3),
    (196.6666666666, 199.9999999999, "Swati", 4),

    # Vishakha (16)
    (199.9999999999, 203.3333333333, "Vishakha", 1),
    (203.3333333333, 206.6666666666, "Vishakha", 2),
    (206.6666666666, 209.9999999999, "Vishakha", 3),
    (209.9999999999, 213.3333333333, "Vishakha", 4),

    # Anuradha (17)
    (213.3333333333, 216.6666666666, "Anuradha", 1),
    (216.6666666666, 219.9999999999, "Anuradha", 2),
    (219.9999999999, 223.3333333333, "Anuradha", 3),
    (223.3333333333, 226.6666666666, "Anuradha", 4),

    # Jyeshtha (18)
    (226.6666666666, 229.9999999999, "Jyeshtha", 1),
    (229.9999999999, 233.3333333333, "Jyeshtha", 2),
    (233.3333333333, 236.6666666666, "Jyeshtha", 3),
    (236.6666666666, 239.9999999999, "Jyeshtha", 4),

    # Mula (19)
    (239.9999999999, 243.3333333333, "Mula", 1),
    (243.3333333333, 246.6666666666, "Mula", 2),
    (246.6666666666, 249.9999999999, "Mula", 3),
    (249.9999999999, 253.3333333333, "Mula", 4),

    # Purva Ashada (20)
    (253.3333333333, 256.6666666666, "Purva Ashada", 1),
    (256.6666666666, 259.9999999999, "Purva Ashada", 2),
    (259.9999999999, 263.3333333333, "Purva Ashada", 3),
    (263.3333333333, 266.6666666666, "Purva Ashada", 4),

    # Uttara Ashada (21)
    (266.6666666666, 269.9999999999, "Uttara Ashada", 1),
    (269.9999999999, 273.3333333333, "Uttara Ashada", 2),
    (273.3333333333, 276.6666666666, "Uttara Ashada", 3),
    (276.6666666666, 279.9999999999, "Uttara Ashada", 4),

    # Shravana (22)
    (279.9999999999, 283.3333333333, "Shravana", 1),
    (283.3333333333, 286.6666666666, "Shravana", 2),
    (286.6666666666, 289.9999999999, "Shravana", 3),
    (289.9999999999, 293.3333333333, "Shravana", 4),

    # Dhanishta (23)
    (293.3333333333, 296.6666666666, "Dhanishta", 1),
    (296.6666666666, 299.9999999999, "Dhanishta", 2),
    (299.9999999999, 303.3333333333, "Dhanishta", 3),
    (303.3333333333, 306.6666666666, "Dhanishta", 4),

    # Shatabhisha (24)
    (306.6666666666, 309.9999999999, "Shatabhisha", 1),
    (309.9999999999, 313.3333333333, "Shatabhisha", 2),
    (313.3333333333, 316.6666666666, "Shatabhisha", 3),
    (316.6666666666, 319.9999999999, "Shatabhisha", 4),

    # Purva Bhadrapada (25)
    (319.9999999999, 323.3333333333, "Purva Bhadrapada", 1),
    (323.3333333333, 326.6666666666, "Purva Bhadrapada", 2),
    (326.6666666666, 329.9999999999, "Purva Bhadrapada", 3),
    (329.9999999999, 333.3333333333, "Purva Bhadrapada", 4),

    # Uttara Bhadrapada (26)
    (333.3333333333, 336.6666666666, "Uttara Bhadrapada", 1),
    (336.6666666666, 339.9999999999, "Uttara Bhadrapada", 2),
    (339.9999999999, 343.3333333333, "Uttara Bhadrapada", 3),
    (343.3333333333, 346.6666666666, "Uttara Bhadrapada", 4),

    # Revati (27)
    (346.6666666666, 349.9999999999, "Revati", 1),
    (349.9999999999, 353.3333333333, "Revati", 2),
    (353.3333333333, 356.6666666666, "Revati", 3),
    (356.6666666666, 360.0,           "Revati", 4),
]


def get_nakshatra(sign: str, degree: float):
    """
    Return (nakshatra_name, pada)
    sign: e.g. "Taurus"
    degree: decimal degree within sign (0~30)
    """
    global_deg = (SIGN_TO_NUM[sign] - 1) * 30 + degree

    for start, end, nk, pada in NAKSHATRA_PADA:
        if start <= global_deg < end:
            return nk, pada

    # fallback (should never occur)
    return None, None
